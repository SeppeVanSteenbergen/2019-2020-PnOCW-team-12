<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<style></style>
	<title>Animation test</title>
</head>

<body>
    <script src="Animations.js" type="text/javascript"></script>
    <script src="Triangle.js" type="text/javascript"></script>
    <script src="Delaunay.js" type="text/javascript"></script>
    <script src="Point.js" type="text/javascript"></script>
    <script src="Line.js" type="text/javascript"></script>

<!--    <h2>Animation Test</h2>-->
    <canvas id="canvas" width= "900" height= "900"></canvas>
    <script>
        var canvas = document.getElementById("canvas")
        let triangulation = Delaunay.triangulation(Delaunay.randomPointsGenerator(6 , canvas), canvas.width, canvas.height)
        let firstPoint = triangulation[0].point1
        let endPoint = triangulation[0].point2
        console.log(firstPoint + "----->" + endPoint)
        var animation1 = new Animations(triangulation, {width: canvas.width, height:canvas.height})
        animation1.setPosition(firstPoint[0], firstPoint[1])
        animation1.setDirection(firstPoint, endPoint)
        animation1.firstPoint = firstPoint
        animation1.endPoint = endPoint


        var animationClient = new Animations(null, {width: canvas.width, height:canvas.height}, true)
        // catImage  = new Image()
        // catImage.src = "catsmall2.png"


        //animation loop

        setInterval(function(){
          canvas.getContext("2d").clearRect(0, 0, canvas.width, canvas.height)

            animationClient.drawBackground(canvas)

            for(let tri = 0; tri < triangulation.length; tri++){
            let ctx = canvas.getContext("2d")
            let triangle = triangulation[tri]
            ctx.beginPath()
            ctx.moveTo(triangle.point1[0], triangle.point1[1])
            ctx.lineTo(triangle.point2[0], triangle.point2[1])
            ctx.lineTo(triangle.point3[0], triangle.point3[1])
            ctx.lineTo(triangle.point1[0], triangle.point1[1])
            ctx.closePath()
            ctx.lineWidth = 2
            ctx.strokeStyle = '#000'
            ctx.stroke()
          }

            //master side
            let info1 = animation1.getNextFrame()

            // client side
            animationClient.drawAnimals(5, 50, canvas, info1.x, info1.y, info1.angle, info1.frame, info1.right)
            // animationClient.drawAnimal(canvas, info1.x, info1.y, info1.angle, info1.frame, info1.right)
            // if (posStack.length > 20){
            //     animationClient.drawAnimal(canvas, posStack[0].x, posStack[0].y, posStack[0].angle, posStack[0].frame, posStack[0].right)
            //     animationClient.drawAnimal(canvas, posStack[10].x, posStack[10].y, posStack[10].angle, posStack[10].frame, posStack[10].right)
            //
            //     posStack.shift()
            // }
            // animation.animateSprite(pos[0],pos[1],catImage, 400, 25, 8)



        }, 50)
        // setInterval(function(){
        //     animation.animateSprite(25,25,catImage, canvas, 400, 25, 8)
        //
        //
        // }, 75)
    </script>
	

</body>

</html>